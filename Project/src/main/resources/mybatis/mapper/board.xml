<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">

    <!-- 전체 1:1문의 조회 select -->
    <select id="select_all" resultType="user.vo.BoardVO" parameterType="String">
        SELECT s.name AS s_name, b.id, b.cus_no, b.prod_no, b.bname, b.title, b.content, b.write_date, b.is_del, b.additional_images,
        r.content AS r_content
        FROM reply r
        INNER JOIN board b ON b.id = r.board_no
        INNER JOIN seller s ON r.seller_no = s.id
        WHERE b.cus_no = #{cus_no} AND b.is_del = 0
        AND b.bname = 'inquiry'
        ORDER BY b.write_date DESC
    </select>

    <select id="select_search" resultType="user.vo.BoardVO">
        SELECT * FROM board
        WHERE is_del = 0 AND cus_no = #{cus_no}
        <if test="status != null and status != 'all'">
            AND status = #{status}
        </if>
        <if test="dateRange == '1-week'">
            AND write_date >= DATE_SUB(NOW(), INTERVAL 7 DAY)
        </if>
        <if test="dateRange == '1-month'">
            AND write_date >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
        </if>
        <if test="dateRange == '3-months'">
            AND write_date >= DATE_SUB(NOW(), INTERVAL 3 MONTH)
        </if>
        <if test="startDate != null and endDate != null">
            AND write_date BETWEEN #{startDate} AND #{endDate}
        </if>
        ORDER BY b.write_date DESC
    </select>
</mapper>